<main class="chat-content" th:fragment="chat-content" xmlns:th="http://www.thymeleaf.org">
    <!-- Server view (giữ nguyên) -->
    <div id="server-chat-view" style="display: none; height: 100%; flex-direction: column;">
        <div class="top-bar">
            <i class="fa-solid fa-hashtag" style="color: #72767d; margin-right: 8px;"></i>
            <span>quy-tắc</span>
        </div>
        <div class="chat-area custom-scrollbar">
            <div class="message">
                <div class="user-avatar" style="width: 40px; height: 40px; margin-right: 16px;"></div>
                <div>
                    <div class="msg-user">System Admin <span
                            style="font-size: 12px; color: #b5bac1; font-weight: normal;">Hôm nay lúc
                            10:30</span></div>
                    <div class="msg-content">Chào mừng đến với Server Test!</div>
                </div>
            </div>
        </div>
        <div class="input-area">
            <div class="input-wrapper">
                <label for="chat-file-upload" class="upload-icon-btn"><i class="fa-solid fa-circle-plus"></i></label>
                <input type="file" id="chat-file-upload" style="display: none;">
                <input type="text" placeholder="Gửi tin nhắn đến #quy-tắc">
                <div class="input-right-icons">
                    <i class="fa-solid fa-gift"></i>
                    <i class="fa-solid fa-face-smile"></i>
                </div>
            </div>
        </div>
    </div>

    <!-- DM dashboard -->
    <div id="dm-dashboard-view" style="display: flex; height: 100%; flex-direction: column;">
        <div class="top-bar friend-header-bar">
            <div class="friend-header-left">
                <div class="friend-title-wrapper">
                    <i class="fa-solid fa-user-group icon-friend"></i>
                    <span class="title-friend">Bạn bè</span>
                </div>
                <div class="vertical-divider"></div>
                <div class="friend-tabs">
                    <button class="tab-item active" id="dmTabAll">Tất cả</button>
                    <button class="tab-item" id="dmTabPending">Đang chờ xử lý</button>
                    <button class="add-friend-btn" id="dmTabAddFriend">Thêm bạn</button>
                </div>
            </div>
        </div>
        <div class="friend-dashboard-body">
            <div class="friend-list-section">
                <!-- Search container: ẩn ở tab "Thêm bạn" -->
                <div class="friend-search-wrapper" id="dm-search-container">
                    <input type="text" id="dm-center-search" placeholder="Tìm kiếm">
                    <i class="fa-solid fa-magnifying-glass"></i>
                </div>

                <!-- View: TẤT CẢ BẠN BÈ -->
                <div id="dm-all-view">
                    <div class="friend-label">TẤT CẢ BẠN BÈ — <span id="dm-center-count">0</span></div>
                    <div id="dm-center-list" class="empty-list-container"></div>
                </div>

                <!-- View: ĐANG CHỜ XỬ LÝ -->
                <div id="dm-pending-view" style="display:none;">
                    <div class="friend-label">ĐÃ NHẬN</div>
                    <div id="dm-pending-in-list" class="empty-list-container"></div>

                    <div class="friend-label" style="margin-top:20px;">ĐÃ GỬI</div>
                    <div id="dm-pending-out-list" class="empty-list-container"></div>
                </div>

                <!-- View: THÊM BẠN -->
                <div id="dm-addfriend-view" style="display:none;">
                    <h3 class="active-now-title" style="margin:0 0 12px 0;">Thêm Bạn</h3>
                    <div style="color:#b9bbbe; margin-bottom:12px;">Bạn có thể thêm bạn bè bằng tên người dùng Discord của họ.</div>
                    <div style="display:flex; align-items:center; gap:12px;">
                        <!-- Input dài ra -->
                        <input type="text" id="dm-addfriend-username" placeholder="Tên người dùng (ví dụ: user3)"
                               style="flex:1; background:#1e1f22; border:1px solid #3f4147; border-radius:4px; color:#dcddde; padding:8px 12px;">
                        <!-- Nút theo đúng chiều rộng chữ -->
                        <button class="add-friend-btn" id="dm-addfriend-send" style="flex:0 0 auto; white-space:nowrap;">Gửi Yêu Cầu Kết Bạn</button>
                    </div>
                    <div id="dm-addfriend-result" style="margin-top:12px; color:#b9bbbe;"></div>
                </div>
            </div>

            <div class="active-now-section">
                <h3 class="active-now-title">Đang hoạt động</h3>
                <div class="empty-active-state">
                    <div class="empty-text-bold">Hiện không có ai đang hoạt động</div>
                </div>
            </div>
        </div>
    </div>

    <!-- DM conversation (giữ nguyên) -->
    <div id="dm-conversation-view" style="display: none; height: 100%; flex-direction: column;">
        <div class="top-bar friend-header-bar">
            <div class="friend-header-left">
                <div class="friend-title-wrapper">
                    <i class="fa-solid fa-user icon-friend"></i>
                    <span id="dm-active-friend-name" class="title-friend">Tin nhắn trực tiếp</span>
                </div>
            </div>
        </div>

        <div id="dm-messages" class="custom-scrollbar" style="flex:1; overflow:auto; padding:16px; display:flex; flex-direction:column; gap:12px;">
            <!-- Render bằng JS -->
        </div>

        <div class="input-area" style="padding:12px; border-top:1px solid #1f2023;">
            <div class="input-wrapper" style="display:flex; align-items:center; gap:12px;">
                <label for="dm-file-upload" class="upload-icon-btn"><i class="fa-solid fa-circle-plus"></i></label>
                <input type="file" id="dm-file-upload" style="display:none;">
                <input type="text" id="dm-input" placeholder="Nhắn tin cho @..." style="flex:1;">
                <div class="input-right-icons">
                    <i class="fa-solid fa-gift"></i>
                    <i class="fa-solid fa-face-smile"></i>
                </div>
            </div>
        </div>
    </div>
</main>